{
  "Question": {
    "Data": {
      "Question": {
        "questionFrontendId": "446",
        "questionId": "446",
        "Content": "<p>Given an integer array <code>nums</code>, return <em>the number of all the <strong>arithmetic subsequences</strong> of</em> <code>nums</code>.</p>\n\n<p>A sequence of numbers is called arithmetic if it consists of <strong>at least three elements</strong> and if the difference between any two consecutive elements is the same.</p>\n\n<ul>\n\t<li>For example, <code>[1, 3, 5, 7, 9]</code>, <code>[7, 7, 7, 7]</code>, and <code>[3, -1, -5, -9]</code> are arithmetic sequences.</li>\n\t<li>For example, <code>[1, 1, 2, 5, 7]</code> is not an arithmetic sequence.</li>\n</ul>\n\n<p>A <strong>subsequence</strong> of an array is a sequence that can be formed by removing some elements (possibly none) of the array.</p>\n\n<ul>\n\t<li>For example, <code>[2,5,10]</code> is a subsequence of <code>[1,2,1,<strong><u>2</u></strong>,4,1,<u><strong>5</strong></u>,<u><strong>10</strong></u>]</code>.</li>\n</ul>\n\n<p>The test cases are generated so that the answer fits in <strong>32-bit</strong> integer.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> nums = [2,4,6,8,10]\n<strong>Output:</strong> 7\n<strong>Explanation:</strong> All arithmetic subsequence slices are:\n[2,4,6]\n[4,6,8]\n[6,8,10]\n[2,4,6,8]\n[4,6,8,10]\n[2,4,6,8,10]\n[2,6,10]\n</pre>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<pre>\n<strong>Input:</strong> nums = [7,7,7,7,7]\n<strong>Output:</strong> 16\n<strong>Explanation:</strong> Any subsequence of this array is arithmetic.\n</pre>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1&nbsp; &lt;= nums.length &lt;= 1000</code></li>\n\t<li><code>-2<sup>31</sup> &lt;= nums[i] &lt;= 2<sup>31</sup> - 1</code></li>\n</ul>\n",
        "SampleTestCase": "[2,4,6,8,10]",
        "ExampleTestcases": "[2,4,6,8,10]\n[7,7,7,7,7]",
        "Difficulty": "Hard",
        "Title": "Arithmetic Slices II - Subsequence",
        "TitleSlug": "arithmetic-slices-ii-subsequence",
        "IsPaidOnly": false,
        "Stats": "{\"totalAccepted\": \"164.3K\", \"totalSubmission\": \"300.2K\", \"totalAcceptedRaw\": 164330, \"totalSubmissionRaw\": 300165, \"acRate\": \"54.7%\"}",
        "Likes": 3471,
        "Dislikes": 165,
        "FreqBar": 0,
        "CategoryTitle": "Algorithms",
        "TopicTags": [
          {
            "Id": "VG9waWNUYWdOb2RlOjU=",
            "Name": "Array",
            "Slug": "array"
          },
          {
            "Id": "VG9waWNUYWdOb2RlOjEz",
            "Name": "Dynamic Programming",
            "Slug": "dynamic-programming"
          }
        ],
        "CodeSnippets": [
          {
            "Lang": "C++",
            "LangSlug": "cpp",
            "Code": "class Solution {\npublic:\n    int numberOfArithmeticSlices(vector<int>& nums) {\n        \n    }\n};"
          },
          {
            "Lang": "Java",
            "LangSlug": "java",
            "Code": "class Solution {\n    public int numberOfArithmeticSlices(int[] nums) {\n        \n    }\n}"
          },
          {
            "Lang": "Python3",
            "LangSlug": "python3",
            "Code": "class Solution:\n    def numberOfArithmeticSlices(self, nums: List[int]) -> int:\n        "
          },
          {
            "Lang": "Python",
            "LangSlug": "python",
            "Code": "class Solution(object):\n    def numberOfArithmeticSlices(self, nums):\n        \"\"\"\n        :type nums: List[int]\n        :rtype: int\n        \"\"\"\n        "
          },
          {
            "Lang": "JavaScript",
            "LangSlug": "javascript",
            "Code": "/**\n * @param {number[]} nums\n * @return {number}\n */\nvar numberOfArithmeticSlices = function(nums) {\n    \n};"
          },
          {
            "Lang": "TypeScript",
            "LangSlug": "typescript",
            "Code": "function numberOfArithmeticSlices(nums: number[]): number {\n    \n};"
          },
          {
            "Lang": "C#",
            "LangSlug": "csharp",
            "Code": "public class Solution {\n    public int NumberOfArithmeticSlices(int[] nums) {\n        \n    }\n}"
          },
          {
            "Lang": "C",
            "LangSlug": "c",
            "Code": "int numberOfArithmeticSlices(int* nums, int numsSize) {\n    \n}"
          },
          {
            "Lang": "Go",
            "LangSlug": "golang",
            "Code": "func numberOfArithmeticSlices(nums []int) int {\n    \n}"
          },
          {
            "Lang": "Kotlin",
            "LangSlug": "kotlin",
            "Code": "class Solution {\n    fun numberOfArithmeticSlices(nums: IntArray): Int {\n        \n    }\n}"
          },
          {
            "Lang": "Swift",
            "LangSlug": "swift",
            "Code": "class Solution {\n    func numberOfArithmeticSlices(_ nums: [Int]) -> Int {\n        \n    }\n}"
          },
          {
            "Lang": "Rust",
            "LangSlug": "rust",
            "Code": "impl Solution {\n    pub fn number_of_arithmetic_slices(nums: Vec<i32>) -> i32 {\n        \n    }\n}"
          },
          {
            "Lang": "Ruby",
            "LangSlug": "ruby",
            "Code": "# @param {Integer[]} nums\n# @return {Integer}\ndef number_of_arithmetic_slices(nums)\n    \nend"
          },
          {
            "Lang": "PHP",
            "LangSlug": "php",
            "Code": "class Solution {\n\n    /**\n     * @param Integer[] $nums\n     * @return Integer\n     */\n    function numberOfArithmeticSlices($nums) {\n        \n    }\n}"
          },
          {
            "Lang": "Dart",
            "LangSlug": "dart",
            "Code": "class Solution {\n  int numberOfArithmeticSlices(List<int> nums) {\n    \n  }\n}"
          },
          {
            "Lang": "Scala",
            "LangSlug": "scala",
            "Code": "object Solution {\n    def numberOfArithmeticSlices(nums: Array[Int]): Int = {\n        \n    }\n}"
          },
          {
            "Lang": "Elixir",
            "LangSlug": "elixir",
            "Code": "defmodule Solution do\n  @spec number_of_arithmetic_slices(nums :: [integer]) :: integer\n  def number_of_arithmetic_slices(nums) do\n    \n  end\nend"
          },
          {
            "Lang": "Erlang",
            "LangSlug": "erlang",
            "Code": "-spec number_of_arithmetic_slices(Nums :: [integer()]) -> integer().\nnumber_of_arithmetic_slices(Nums) ->\n  ."
          },
          {
            "Lang": "Racket",
            "LangSlug": "racket",
            "Code": "(define/contract (number-of-arithmetic-slices nums)\n  (-> (listof exact-integer?) exact-integer?)\n  )"
          }
        ],
        "CompanyTagStats": ""
      }
    },
    "DownloadedAt": "2025-11-17T15:17:05.838612+01:00",
    "AcRate": "54.7",
    "TotalSubmissions": 300165,
    "TotalAccepted": 164330,
    "AcceptanceRate": 0.5474655606083321,
    "ContentFeatures": "",
    "CodeSnippetFeatures": {
      "c": "",
      "cpp": "",
      "csharp": "",
      "dart": "",
      "elixir": "",
      "erlang": "",
      "golang": "",
      "java": "",
      "javascript": "",
      "kotlin": "",
      "php": "",
      "python": "",
      "python3": "",
      "racket": "",
      "ruby": "",
      "rust": "",
      "scala": "",
      "swift": "",
      "typescript": ""
    },
    "Url": "https://leetcode.com/problems/arithmetic-slices-ii-subsequence/"
  },
  "Solutions": {
    "deepseek/deepseek-chat-v3.1": {
      "Lang": "python3",
      "Prompt": "Hi, this is a coding interview. You will be given:\n* A problem statement (with sample test cases if available).\n* A starter code snippet (with fixed function signatures).\n\nPlease write your solution in the python3 programming language. Your code must:\n* Solve the problem fully and correctly.\n* Pass all provided sample test cases.\n* Run within acceptable time and memory limits (assume large inputs if none are specified).\n* Follow good coding practices (clear logic, readable structure, appropriate use of language features).\n\nHere is the problem statement: Given an integer array nums, return the number of all the arithmetic subsequences of nums.\nA sequence of numbers is called arithmetic if it consists of at least three elements and if the difference between any two consecutive elements is the same.\n\tFor example, [1, 3, 5, 7, 9], [7, 7, 7, 7], and [3, -1, -5, -9] are arithmetic sequences.\n\tFor example, [1, 1, 2, 5, 7] is not an arithmetic sequence.\nA subsequence of an array is a sequence that can be formed by removing some elements (possibly none) of the array.\n\tFor example, [2,5,10] is a subsequence of [1,2,1,2,4,1,5,10].\nThe test cases are generated so that the answer fits in 32-bit integer.\n\u00a0\nExample 1:\nInput: nums = [2,4,6,8,10]\nOutput: 7\nExplanation: All arithmetic subsequence slices are:\n[2,4,6]\n[4,6,8]\n[6,8,10]\n[2,4,6,8]\n[4,6,8,10]\n[2,4,6,8,10]\n[2,6,10]\nExample 2:\nInput: nums = [7,7,7,7,7]\nOutput: 16\nExplanation: Any subsequence of this array is arithmetic.\n\u00a0\nConstraints:\n\t1\u00a0 <= nums.length <= 1000\n\t-2^31 <= nums[i] <= 2^31 - 1\n\nHere is the code snippet, which you should expand with your solution: class Solution:\n    def numberOfArithmeticSlices(self, nums: List[int]) -> int:\n        \n\nImportant Requirements:\n* Do not change any provided function signatures, class names, or method names.\n* Output only valid source code that can be executed as-is, without any further improvements or bugfixes.\n* Do not include docstrings, markdown, or commentary in your final code.\n\nGood luck!\n",
      "Answer": "To solve this problem, we need to count the number of arithmetic subsequences in an array. An arithmetic subsequence must have at least three elements, and the difference between consecutive elements must be constant. The challenge is to efficiently count all such subsequences without enumerating all possible subsequences explicitly due to the constraints (array length up to 1000).\n\n### Approach\n1. **Dynamic Programming (DP) Setup**: We will use dynamic programming to store the state of subsequences ending at each index with a specific common difference. The idea is to use a list of dictionaries (dp) where each index i has a dictionary. The key in the dictionary will be the common difference (diff), and the value will be the count of subsequences ending at i with that difference.\n\n2. **Iterate Through Pairs**: For each index i, we look at all previous indices j (j < i). For each pair (j, i), we calculate the difference `diff = nums[i] - nums[j]`. This difference might be large, so we use integer arithmetic.\n\n3. **Update DP State**: For each pair (j, i), we check if j has any subsequences ending with difference `diff`. Specifically:\n   - If j has an entry for `diff`, it means there are subsequences ending at j with that difference. Then, the subsequences ending at j can be extended to i. So, we add the count from j to i's count for the same difference.\n   - Additionally, every such pair (j, i) forms a new subsequence of length 2. However, we are only interested in subsequences of length at least 3. Therefore, we also consider that extending a subsequence from j (which already has at least length 2) to i will form a valid subsequence of length at least 3. Hence, we add the count from j's dictionary to our overall answer.\n\n4. **Count Valid Subsequences**: For each extension from j to i, the count stored at j for `diff` represents the number of subsequences ending at j with difference `diff` (which are at least of length 2). When we extend these to i, we get valid subsequences of length at least 3. Therefore, we add the value from j's dictionary to the result.\n\n5. **Update Current Dictionary**: For the current index i, we update its dictionary for the key `diff` by adding 1 (for the subsequence [j, i]) and also adding the value from j's dictionary for `diff` (to account for extensions of longer sequences). This ensures that the dictionary at i accumulates all subsequences ending at i with difference `diff`.\n\n### Solution Code\n```python\nclass Solution:\n    def numberOfArithmeticSlices(self, nums: List[int]) -> int:\n        n = len(nums)\n        dp = [dict() for _ in range(n)]\n        total = 0\n        for i in range(n):\n            for j in range(i):\n                diff = nums[i] - nums[j]\n                count_j = dp[j].get(diff, 0)\n                total += count_j\n                dp[i][diff] = dp[i].get(diff, 0) + count_j + 1\n        return total\n```\n\n### Explanation\n1. **Initialization**: We initialize a list `dp` of dictionaries with the same length as `nums`. Each dictionary will map a common difference to the number of subsequences ending at that index with that difference.\n2. **Iterating Pairs**: For each index `i` and each previous index `j`, we compute the difference `diff` between `nums[i]` and `nums[j]`.\n3. **Counting Valid Sequences**: The value `count_j` from `dp[j]` for key `diff` represents the number of subsequences (at least length 2) ending at `j` with difference `diff`. Each of these can be extended to `i` to form a valid arithmetic subsequence of length at least 3, so we add `count_j` to the total result.\n4. **Updating DP State**: We update `dp[i]` for key `diff` by adding `count_j` (to account for extensions of sequences from `j`) and 1 (for the new two-element subsequence [j, i]). This ensures that future indices can extend these sequences further.\n5. **Result**: The variable `total` accumulates all valid arithmetic subsequences of length at least 3 found during the process, which is returned as the result.\n\nThis approach efficiently counts all arithmetic subsequences without explicitly generating them, leveraging dynamic programming to avoid redundant calculations. The time complexity is O(n^2), which is feasible for n up to 1000.",
      "TypedCode": "\nclass Solution:\n    def numberOfArithmeticSlices(self, nums: List[int]) -> int:\n        n = len(nums)\n        dp = [dict() for _ in range(n)]\n        total = 0\n        for i in range(n):\n            for j in range(i):\n                diff = nums[i] - nums[j]\n                count_j = dp[j].get(diff, 0)\n                total += count_j\n                dp[i][diff] = dp[i].get(diff, 0) + count_j + 1\n        return total\n",
      "Model": "deepseek/deepseek-chat-v3.1",
      "Latency": 12887755041,
      "SolvedAt": "2025-11-20T21:12:04.615366+01:00",
      "PromptTokens": 561,
      "OutputTokens": 988
    }
  },
  "Submissions": {
    "deepseek/deepseek-chat-v3.1": {
      "SubmitRequest": {
        "lang": "python3",
        "question_id": "446",
        "typed_code": "\nclass Solution:\n    def numberOfArithmeticSlices(self, nums: List[int]) -> int:\n        n = len(nums)\n        dp = [dict() for _ in range(n)]\n        total = 0\n        for i in range(n):\n            for j in range(i):\n                diff = nums[i] - nums[j]\n                count_j = dp[j].get(diff, 0)\n                total += count_j\n                dp[i][diff] = dp[i].get(diff, 0) + count_j + 1\n        return total\n"
      },
      "SubmissionId": 0,
      "CheckResponse": {
        "status_code": 10,
        "status_msg": "Accepted",
        "Finished": true,
        "State": "SUCCESS"
      },
      "SubmittedAt": "2025-11-20T22:39:02+01:00"
    }
  }
}